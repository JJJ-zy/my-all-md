# 网络基础

## OSI七层模型

| 层（从上到下） | 作用                                                         |
| -------------- | ------------------------------------------------------------ |
| 应用层         | 定义了数据格式协议规范，http,https,ftp,sftp,dns              |
| 表示层         | 对不同的操作系统进行翻译，使用同一种公共语言                 |
| 会话层         | 断点续传，从校验点恢复数据传输，自动收发，自动寻址           |
| 传输层         | （1）对数据封装，TCP,UDP协议，可以防止数据丢失<br />（2）定义端口的概念，寻找对应的程序 |
| 网络层         | （1）获取MAC地址，ARP协议（address resolution protocol地址解析协议,通过ip解析）<br />（2）判断是否在同一个子网 ，IP协议<br />（3）选择最优路径，一组路由协议(静态路由，动态路由（RIP,OSPF,BGP）) |
| 数据链路层     | （1）处理比特流，8个bit为一组，每一组称为一帧，<br />（2）会带上MAC地址 |
| 物理层         | 物理介质（光纤）,传输形式二进制  （比特流）                  |

> OSI七层模型和TCP/IP模型

![image-20211108083858137](C:\Users\zwj\AppData\Roaming\Typora\typora-user-images\image-20211108083858137.png)

数据链路层  === 网络接口层

常用TCP/IP模型

## 数据传输过程

![image-20211108084055213](C:\Users\zwj\AppData\Roaming\Typora\typora-user-images\image-20211108084055213.png)

## ARP协议

> 概念

```tex
address resolution protocol 地址解析协议，通过ip解析mac地址
```

> 工作原理

```tex
通过ARP缓存表获取MAC地址
每台电脑都维护着一个ARP缓存表
表的关系为<IP地址，MAC地址>
缓存表数据有寿命值TTL，默认存活时间10分钟
表中记录着最近运行时获得的ip/mac映射

总而言之，ARP协议就是对ARP缓存表进行增删改查
```

> 当ARP缓存表中不存在映射关系时

```tex
局域网中
在局域网广播一个ARP请求，处于同一局域网中的所有主机都会接收到请求，如果目标ip地址与主机当前ip地址吻合，就会返回一个ARP应答，告诉请求者自身的MAC地址，请求主机收到后添加到ARP缓存表中，再发送数据

ARP的核心就是对ARP缓存表进行操作
```

```tex
外网中
通过网关中转，对网关发起arp广播，全F，获取网关的mac地址，然后将缓存中的数据封装网关mac进行传输
网关接收到数据后，发现不是给自己的，进行路由，在自己的路由表中查询到ip进行arp请求，获取mac地址传输数据
```

## IP协议

> ipv4

```tex
32位二进制 和  十进制
```

> ipv6

```tex
128位 分8个字段，每块有4个16进制
```

> IP地址组成

```tex
IP地址 = 网络号 + 子网ID + 主机号
```

> 子网掩码

```tex
将ip地址与子网掩码进行“按位与”运算，就能得出用于路由的“子网标识符”，如：

ip地址：  128.32.1.14 对应二进制：10000000 00100000 00000001 00001110

掩码地址： 255.255.255.0 对应二进制：11111111 11111111 11111111 00000000

子网标识符 128.32.1.0 对应二进制：10000000 00100000 00000001 00000000

通过上面的运算我们可以看出：128.32.1.14这个地址属于子网“128.32.1.0”
```

![image-20211110120122935](C:\Users\zwj\AppData\Roaming\Typora\typora-user-images\image-20211110120122935.png)

> 网络地址和广播地址

```tex
子网段中的首个地址和末尾地址是不可用的 256个主机，只有254个可用
首个为网络地址，子网标识符
末尾为广播地址，发送信息到子网下所有主机
```

## 路由协议

 ```tex
指定数据包转送方式的网上协议
 ```

> 静态路由

```tex
目的地址---指定下一跳  指定跳转路线   默认路由（主机--默认网关）
```

> 动态路由

```tex
配置之后，动态学习路由条目  ----路由表
```

